# Specification Structure Reference

**Created**: 2025-11-18  
**Purpose**: Working reference for spec structure and artifacts across sprints

## Standard Spec Directory Structure

Each spec follows this pattern:

```
specs/NNN-feature-name/
├── checklists/
│   └── requirements.md          # Quality validation checklist
├── contracts/                   # Feature-specific contracts and schemas
│   ├── config-*.yaml           # Configuration additions
│   ├── secrets-*.yaml          # Secret/credential templates
│   └── *.json|*.sql            # API samples, schemas, etc.
├── spec.md                      # Main specification (generated by /speckit.specify)
├── plan.md                      # Implementation plan (generated by /speckit.plan)
├── tasks.md                     # Task breakdown (optional, after planning)
├── research.md                  # Research notes (optional)
├── data-model.md               # Data model details (optional)
├── quickstart.md               # Quick reference (optional)
└── sprint-N-summary.md         # Sprint retrospective (after completion)
```

## Completed Specs

### Spec 001: Project Foundation

**Branch**: `001-project-foundation`  
**Status**: Completed  
**Artifacts**:
- ✅ `spec.md` - Foundation specification
- ✅ `plan.md` - Implementation plan
- ✅ `tasks.md` - Task breakdown
- ✅ `checklists/requirements.md` - Quality checklist
- ✅ `contracts/config.yaml` - Main configuration template
- ✅ `contracts/secrets.yaml.example` - Secrets template
- ✅ `contracts/database-schema.sql` - SQLite schema definition
- ✅ `data-model.md` - Database schema documentation
- ✅ `research.md` - Technical research notes
- ✅ `quickstart.md` - Setup quick reference
- ✅ `sprint-0-summary.md` - Sprint retrospective

**Key Deliverables**:
- Project structure and directory layout
- Python virtual environment setup
- Configuration management (YAML-based)
- SQLite database schema with readings table
- Data validation framework
- Logging infrastructure

### Spec 002: Philips Hue Integration

**Branch**: `002-hue-integration`  
**Status**: Specification complete, ready for planning  
**Artifacts**:
- ✅ `spec.md` - Hue integration specification
- ✅ `checklists/requirements.md` - Quality checklist (validated)
- ✅ `contracts/config-hue.yaml` - Hue configuration template
- ✅ `contracts/secrets-hue.yaml` - Hue Bridge credentials template
- ✅ `contracts/hue-api-response-sample.json` - API response samples and mapping

**Key Deliverables** (planned):
- Hue Bridge discovery and authentication
- Temperature sensor discovery and enumeration
- Temperature data collection from Hue sensors
- Database storage integration

## Contract Types by Feature

### Foundation (001)
- `config.yaml` - Main system configuration
- `secrets.yaml.example` - Template for all secrets
- `database-schema.sql` - Central database schema

### Hue Integration (002)
- `config-hue.yaml` - Hue-specific settings (discovery, collection, validation)
- `secrets-hue.yaml` - Hue Bridge IP and API key
- `hue-api-response-sample.json` - Sample API responses with field mappings

### Future Specs Pattern
Each data source integration should include:
- `config-{source}.yaml` - Source-specific configuration
- `secrets-{source}.yaml` - Source-specific credentials
- `{source}-api-response-sample.json` - API contract documentation

## Checklist Template

All specs use standardized quality checklist (`checklists/requirements.md`):
- Content Quality (no implementation details, stakeholder-focused)
- Requirement Completeness (testable, measurable, unambiguous)
- Feature Readiness (acceptance criteria, success criteria)

## Database Schema Evolution

**Current Version**: 1 (from spec 001)

**Schema Location**: `specs/001-project-foundation/contracts/database-schema.sql`

**Key Tables**:
- `readings` - Core temperature data with device_id, timestamp, temperature, location
- `schema_version` - Schema version tracking for migrations

**Device ID Format**: Composite `source_type:device_id`
- Hue sensors: `hue:sensor_unique_id`
- Nest thermostats: `nest:thermostat_id`
- Weather API: `weather:outside`

## Configuration File Integration

### Main Files (in project root `/config/`)
- `config.yaml` - Merged from all `contracts/config*.yaml` files
- `secrets.yaml` - Merged from all `contracts/secrets*.yaml` files (gitignored)

### Integration Pattern
When implementing a spec, configuration contracts should be:
1. Added to main config files in `/config/`
2. Documented in spec's contract files as templates
3. Kept synchronized between spec contracts and actual config

## Sprint Planning Artifacts

### Before Planning (`/speckit.specify`)
- `spec.md` - Complete
- `checklists/requirements.md` - Complete and validated
- `contracts/` - All necessary contracts defined

### After Planning (`/speckit.plan`)
- `plan.md` - Implementation roadmap with tasks
- `tasks.md` - Detailed task breakdown (optional)
- `research.md` - Technical research (optional)

### After Implementation
- `sprint-N-summary.md` - Retrospective and outcomes
- Updated contracts moved to main project config files

## Notes for Future Agents

1. **Always check existing specs** for structure patterns before creating new ones
2. **Contracts are contracts** - they define the interface between components
3. **Spec 001 is the foundation** - all other specs build on its schema and config
4. **Device ID format is sacred** - always use `source_type:device_id` composite format
5. **Temperature units are metric** - always store as Celsius
6. **Timestamps are ISO 8601** - always include timezone information
7. **No implementation details in specs** - specs are technology-agnostic (what/why, not how)

## Quick Reference Commands

- `/speckit.specify "description"` - Create new spec with validation
- `/speckit.plan` - Generate implementation plan from spec
- `/speckit.clarify` - Add clarifications to existing spec

---

**Last Updated**: 2025-11-18  
**Maintainer**: Update this file when new specs are created or patterns emerge
