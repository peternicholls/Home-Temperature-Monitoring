# Collection settings
collection:
  interval_seconds: 300
  retry_attempts: 3
  retry_backoff_base: 1.0
# Storage settings
storage:
  database_path: "data/readings.db"
  enable_pooling: false

  # NEW: Write-Ahead Logging mode
  enable_wal_mode: true
  wal_checkpoint_interval: 1000 # Checkpoint every 1000 writes (0 = auto)

  # NEW: Database retry configuration
  retry_max_attempts: 3 # Number of retry attempts for database locked errors
  retry_base_delay: 1.0 # Base delay in seconds for exponential backoff (1s, 2s, 4s)
  busy_timeout_ms: 5000 # SQLite busy timeout (milliseconds)
# Logging settings
logging:
  level: "INFO"
  enable_file_logging: true
  log_file_path: "logs/collection.log"

  # NEW: Rotation configuration
  max_bytes: 10485760 # 10MB - rotate when file reaches this size
  backup_count: 5 # Keep 5 backup files (total max: 60MB)
  encoding: "utf-8" # Log file encoding
# Validation settings
validation:
  indoor_temp_min: 0
  indoor_temp_max: 40
  outdoor_temp_min: -40
  outdoor_temp_max: 50
  allow_out_of_range: true
# Collector-specific settings
collectors:
  general:
    fallback_location: "Home" # Default location if device not in registry

  hue:
    enabled: true
    timeout_seconds: 10
    bridge_ip: null # Auto-discover if null
    auto_discover: true
    collection_interval: 300
    retry_attempts: 3
    retry_backoff_base: 2
    fallback_to_name: true
    temperature_min: 0.0
    temperature_max: 40.0
    collect_battery_level: true
    collect_signal_strength: true
    collect_raw_response: false

  amazon_aqm:
    enabled: false # Disabled by default (requires cookie auth)
    domain: "alexa.amazon.co.uk" # UK domain (adjust per region)
    device_serial: null # Auto-discover if null, or specify: "GAJ23005314600H3"
    timeout_seconds: 30
    collection_interval: 300 # 5 minutes (same as Hue)
    retry_attempts: 3
    retry_backoff_base: 1.0
    max_timeout: 120

    # Validation ranges (optional - already in schema)
    temperature_min: 0.0
    temperature_max: 40.0
    humidity_min: 0.0
    humidity_max: 100.0
    iaq_min: 0
    iaq_max: 100

    # What to collect
    collect_temperature: true
    collect_humidity: true
    collect_pm25: true
    collect_voc: true
    collect_co: true
    collect_iaq: true
    collect_connectivity: false # Don't store as separate field
    collect_raw_response: false # Save full API response in raw_response column

  nest:
    enabled: false
    timeout_seconds: 10
  weather:
    enabled: false
    timeout_seconds: 10
